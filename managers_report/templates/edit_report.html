{% extends "base.html" %}
{% block title %}Edit Report â€” Manager Dashboard{% endblock %}
{% block content %}
<div class="py-2 sm:py-4 lg:py-6 mobile-nav w-full">
  <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-3 sm:mb-4 lg:mb-6 gap-3">
    <h2 class="text-lg sm:text-xl lg:text-2xl font-bold text-gray-800">Edit Report</h2>
    <button id="btnFilter" type="submit" form="filterForm"
            class="py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition duration-200 text-sm sm:text-base">
      Filter Reports
    </button>
  </div>

  <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-2 sm:p-3 lg:p-6 mb-3 sm:mb-4 lg:mb-6 w-full">
    <form id="filterForm" method="post" class="flex flex-col gap-2 sm:gap-3 w-full">
      <div class="w-full">
        <label for="datePicker" class="block text-sm font-medium text-gray-700">Select Date</label>
        <input id="datePicker" type="date" name="date" value="{{ selected_date }}"
               class="mt-1 p-2 w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mobile-btn">
      </div>
      <div class="w-full">
        <label for="employeeSelect" class="block text-sm font-medium text-gray-700">Select Employee</label>
        <select id="employeeSelect" name="employee"
                class="mt-1 p-2 w-full border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mobile-btn">
          <option value="">-- Select Employee --</option>
          {% for emp in employees %}
          <option value="{{ emp.telegram_id }}" {% if emp.telegram_id == selected_employee %}selected{% endif %}>
            {{ emp.name }}
          </option>
          {% endfor %}
        </select>
      </div>
    </form>
  </div>

  <div class="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden w-full">
    <div class="mobile-table w-full">
      <table class="w-full table-auto">
        <thead>
          <tr class="bg-blue-50 text-gray-700">
            <th class="p-2 lg:p-3 font-bold text-left text-xs sm:text-sm lg:text-base">Report ID</th>
            <th class="p-2 lg:p-3 font-bold text-left text-xs sm:text-sm lg:text-base">Date</th>
            <th class="p-2 lg:p-3 font-bold text-left text-xs sm:text-sm lg:text-base">Site</th>
            <th class="p-2 lg:p-3 font-bold text-left text-xs sm:text-sm lg:text-base">Drone</th>
            <th class="p-2 lg:p-3 font-bold text-left text-xs sm:text-sm lg:text-base">Created At</th>
            <th class="p-2 lg:p-3 font-bold text-left text-xs sm:text-sm lg:text-base">Actions</th>
          </tr>
        </thead>
        <tbody id="reportsTableBody">
          <!-- Rows inserted by JS -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- View Modal (MOBILE-FRIENDLY) -->
  <div id="viewModal" class="fixed inset-0 hidden z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-3 lg:p-6 rounded-xl shadow-lg max-w-2xl w-[95%] lg:w-full max-h-screen overflow-y-auto mobile-modal">
      <h3 class="text-base lg:text-lg font-semibold text-gray-800 mb-4">Report Preview</h3>
      <div id="viewModalContent"></div>
      <button onclick="document.getElementById('viewModal').classList.add('hidden')" class="mt-4 py-2 px-4 bg-gray-600 text-white rounded-lg hover:bg-gray-700 mobile-btn w-full lg:w-auto">Close</button>
    </div>
  </div>

  <!-- Edit Modal (MOBILE-FRIENDLY) -->
  <div id="editModal" class="fixed inset-0 hidden z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-3 lg:p-6 rounded-xl shadow-lg max-w-2xl w-[95%] lg:w-full max-h-screen overflow-y-auto mobile-modal">
      <h3 class="text-base lg:text-lg font-semibold text-gray-800 mb-4">Edit Report</h3>
      <div id="editModalContent"></div>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='app.js') }}"></script>
{% endblock %}